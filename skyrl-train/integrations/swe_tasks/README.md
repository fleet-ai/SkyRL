# SWE Task Generator Integration

Train a coding agent on tasks generated by [swe-task-generator](https://github.com/fleet-ai/swe-task-generator).

## How It Works

1. **Task instances** are generated from GitHub PRs (see swe-task-generator Part 1)
2. Each task has a Docker image on Docker Hub + an eval_script.sh
3. During training, the agent interacts with the Docker container via bash commands
4. The agent tries to fix the bug described in the problem statement
5. Reward = 1.0 if eval_script passes, 0.0 if it fails

## Quick Start

### 1. Prepare Dataset

```bash
cd SkyRL/skyrl-train

uv run --isolated integrations/swe_tasks/prepare_dataset.py \
  --tasks-dir /path/to/swe-task-generator/tasks \
  --output-dir ~/data/swe_tasks
```

### 2. Launch Training (GPU cluster)

```bash
# Local GPU cluster (8xH100)
bash integrations/swe_tasks/run_swe_tasks_8B.sh

# Via SkyPilot (cloud GPU)
sky launch tasks/swe-tasks-grpo-qwen3-8b.yaml --env WANDB_API_KEY=<key>
```

### 3. Verify Reward Signal (no GPU needed)

```bash
cd /path/to/swe-task-generator
python show_reward.py
```

## Architecture

```
SkyRL Training Loop
    │
    ├── Qwen3-8B generates bash commands
    │   (explores repo, reads code, writes fixes)
    │
    ├── mini-swe-agent executes in Docker container
    │   (image pulled from Docker Hub)
    │
    ├── Agent submits: git diff --cached
    │
    └── Evaluation:
        ├── git apply <agent_patch>
        ├── bash eval_script.sh
        └── reward = 1.0 if exit_code == 0 else 0.0
```

## Configuration

- `swe_tasks.yaml` — Agent system prompt, step limit, Docker settings
- `run_swe_tasks_8B.sh` — Training hyperparameters (batch size, lr, etc.)
- `tasks/swe-tasks-grpo-qwen3-8b.yaml` — SkyPilot cloud deployment config

## Task Format

Each task instance in the dataset has:
- `instance_id`: e.g., "marshmallow-code-marshmallow-2894"
- `problem_statement`: Description of the bug to fix
- `eval_script`: Shell script that returns 0 on success
- `image_name`: Docker Hub image with the repo at the buggy commit
- `gold_patch`: Reference fix (used for evaluation, not shown to agent)
